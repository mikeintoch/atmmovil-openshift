kind: List
apiVersion: v1
items:

- kind: ImageStream
  apiVersion: v1
  metadata:
    labels:
      app: atmmovil
    name: atmmovil
  spec: {}

- kind: BuildConfig
  apiVersion: v1
  metadata:
    labels:
      app: atmmovil
    name: atmmovil
  spec:
    output:
      to:
        kind: ImageStreamTag
        name: atmmovil:latest
    source:
      git:
        uri: https://github.com/mikeintoch/atmmovil-openshift.git
      type: Git
    strategy:
      dockerStrategy:
        env:
        - name: appname
          value: atm_movil-webclient
        - name: apppkg
          value: atm_movil-webclient-1.0-SNAPSHOT.war
        - name: dsName
          value: ds_atm_movil
        - name: dsDatabaseName
          value: test
        - name: datasourceTarget
          value: AdminServer
        - name: dsJNDIName
          value: jdbc/atm_movil
        - name: dsDriverName
          value: oracle.jdbc.OracleDriver
        - name: dsURL
          value: jdbc:oracle:thin:@//192.168.42.1:1521/xe
        - name: dsUserName
          value: UGATMMOVILADMIN
        - name: dsPassword
          value: redhat
        - name: dsTestQuery
          value: SQL ISVALID
        from:
          kind: DockerImage
          name: rhel7-weblogic-domain:latest
      type: Docker
    triggers:
    - type: ConfigChange
    - imageChange: {}
      type: ImageChange

- kind: DeploymentConfig
  apiVersion: v1
  metadata:
    labels:
      app: atmmovil
    name: atmmovil
  spec:
    replicas: 1
    selector:
      app: atmmovil
      deploymentconfig: atmmovil
    strategy:
      resources: {}
    template:
      metadata:
        annotations:
          openshift.io/container.atmmovil.image.entrypoint: '["startWebLogic.sh"]'
        labels:
          app: atmmovil
          deploymentconfig: atmmovil
      spec:
        containers:
        - image: atmmovil:latest
          name: atmmovil
          ports:
          - containerPort: 8001
            protocol: TCP
    triggers:
    - type: ConfigChange
    - imageChangeParams:
        automatic: true
        containerNames:
        - atmmovil
        from:
          kind: ImageStreamTag
          name: atmmovil:latest
      type: ImageChange

- kind: Service
  apiVersion: v1
  metadata:
    labels:
      app: atmmovil
    name: atmmovil
  spec:
    ports:
    - name: 8001-tcp
      port: 8001
      protocol: TCP
      targetPort: 8001
    selector:
      app: atmmovil
      deploymentconfig: atmmovil
